---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
import heroImage from '../assets/hero-picture.jpeg';
import { research } from '../data/research';
import { supporters } from '../data/supporters';
import ResearchCarousel from '../components/ResearchCarousel.astro';
---

<Layout 
  title="Durham AI Safety Initiative"
  description="Durham AI Safety Initiative (DAISI) at Durham University: events, research, seminars and community focused on reducing catastrophic risks from advanced AI."
    heroImage={heroImage.src}
>
  <script
    type="application/ld+json"
    slot="head"
    set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Durham AI Safety Initiative",
      "alternateName": "DAISI",
      "url": "https://durhamaisafety.com",
      "description": "Student-led initiative at Durham University focused on reducing catastrophic risks from advanced AI through education, research, and community building.",
      "foundingLocation": {
        "@type": "Place",
        "name": "Durham University",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Durham",
          "addressCountry": "UK"
        }
      },
      "areaServed": "Durham University",
      "memberOf": {
        "@type": "EducationalOrganization",
        "name": "Durham University"
      }
    })}
  />
    <!-- Hero Section -->
    <section id="home" class="hero-section min-h-100dvh min-h-100svh min-h-100vh flex items-center justify-center relative overflow-hidden">
        <!-- Hero Image with Parallax -->
        <div class="hero-parallax-container">
            <Image
                src={heroImage}
                alt="Durham Cathedral"
                class="hero-parallax-image"
                widths={[640, 768, 1024, 1280, 1536, 1920]}
                sizes="100vw"
                loading="eager"
                decoding="async"
            />
        </div>
        <div class="absolute inset-0 bg-gradient-to-br from-black/60 via-black/50 to-black/40"></div>
    <div class="site-container mx-auto px-6 text-center relative z-10">
            <div class="max-w-6xl mx-auto space-y-6 md:space-y-8">
                <h1 class="text-3xl md:text-4xl lg:text-6xl font-bold leading-relaxed" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 10px rgba(0,0,0,0.6);">
                    <span class="text-white">Durham students and academics for </span><span class="text-bright-purple italic font-medium">reducing catastrophic risks from advanced AI</span>
                </h1>
                
                <p class="text-xl md:text-2xl lg:text-3xl max-w-3xl mx-auto leading-relaxed mb-6 md:mb-8" style="text-shadow: 1px 1px 3px rgba(0,0,0,0.8), 0 0 8px rgba(0,0,0,0.5);">
                    <span class="font-semibold text-light-purple">Whatever your expertise,</span> 
                    <span class="text-white">you can contribute to the conversation and make a difference.</span>
                </p>
                
                <div class="pt-2 md:pt-4">
                    <a href="/get-involved/"
                       class="inline-block px-12 py-4 bg-durham-purple hover:bg-[#7a2d80] text-white font-bold text-lg rounded-full transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 border-2 border-white/20">
                        Get Involved
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Events Section -->
    <section id="events" class="py-16 section-neutral">
    <div class="site-container mx-auto px-6 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold mb-6">Our Events</h2>
                <div class="w-24 h-1 bg-gradient-to-r from-bright-purple to-light-purple mx-auto rounded-full"></div>
            </div>
            
            <div id="calendar" class="max-w-5xl mx-auto mb-16">
                <p class="text-center text-lg mb-4 font-medium">
                    We'll update this calendar with upcoming events. Go <a href="https://luma.com/daisi" target="_blank" rel="noopener noreferrer" class="text-durham-purple hover:text-bright-purple underline font-medium">here</a> and click <i class="fa-solid fa-square-rss"></i> to sync with your calendar!
                </p>
                <p class="text-center text-sm mb-8 text-slate-600">
                    If you prefer the classic Google Calendar, you can find that <a href="https://calendar.google.com/calendar/embed?src=896edcf4f9cd47305232b2c78cc06d4d1365a18dabbace749bde237cfd92bea6%40group.calendar.google.com&ctz=Europe%2FLondon" target="_blank" rel="noopener noreferrer" class="text-durham-purple hover:text-bright-purple underline font-medium">here</a>.
                </p>
                <div class="bg-white/20 backdrop-blur rounded-2xl p-4 border border-bright-purple/30 calendar-container">
                    <!-- Loading state -->
                    <div id="calendar-loading" class="calendar-loading">
                        <div class="text-center">
                            <div class="spinner mx-auto mb-4"></div>
                            <p class="text-bright-purple font-medium">Loading calendar...</p>
                        </div>
                    </div>
                    
                    <!-- Calendar iframe -->
                    <div class="overflow-hidden rounded-xl luma-calendar-wrapper">                            
                        <iframe
                            id="calendar-iframe" 
                            title="Durham AISI Events Calendar"
                            src="https://luma.com/embed/calendar/cal-lvIwlKjJGAceOBN/events"
                            frameborder="0"
                            class="calendar-iframe"
                            allowfullscreen=""
                            aria-hidden="false"
                            tabindex="0"
                            style="border: none;"
                        ></iframe>
                    </div>
                </div>
                <p class="text-center text-sm mt-8 text-slate-600">
                    <a href="https://luma.com/daisi?period=past" target="_blank" rel="noopener noreferrer" class="text-durham-purple hover:text-bright-purple underline font-medium">See past events here</a>.
                </p>
            </div>
            
            <!-- Program Cards -->
            <div class="max-w-6xl mx-auto mb-16">
                <!-- First row: 2 main cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="program-card rounded-2xl p-8 text-center">
                        <div class="mb-6">
                            <i class="fas fa-chalkboard-teacher text-5xl text-durham-purple mb-4"></i>
                            <h4 class="text-2xl font-bold">Intro Seminars</h4>
                            <div class="w-16 h-1 bg-durham-purple mx-auto rounded-full mt-3"></div>
                        </div>
                        <p class="mb-6 leading-relaxed text-slate-600">
                            Regular sessions exploring core AI safety concepts in an accessible, interactive format.
                        </p>
                        <div class="flex items-center justify-center gap-2 mb-6">
                            <i class="fa-solid fa-users text-durham-purple" aria-hidden="true"></i>
                            <span class="text-sm text-slate-600">No technical background needed</span>
                        </div>
                        <a href="/programs/#intro-seminars" class="inline-block px-6 py-2 bg-durham-purple text-white font-medium text-sm rounded-lg transition-colors duration-300 hover:bg-[#7a2d80]">
                            Learn More
                        </a>
                    </div>
                
                    <div class="program-card rounded-2xl p-8 text-center">
                        <div class="mb-6">
                            <i class="fas fa-book-open text-5xl text-durham-purple mb-4"></i>
                            <h4 class="text-2xl font-bold">In-Depth Reading Groups</h4>
                            <div class="w-16 h-1 bg-durham-purple mx-auto rounded-full mt-3"></div>
                        </div>
                        <p class="mb-6 leading-relaxed text-slate-600">
                            Deeper discussion on AI safety papers with PhD students specialising in the areas. 
                            Open to anyone - aimed at those wanting to get into the nitty-gritty technical details of alignment or policy.
                        </p>
                        <div class="flex items-center justify-center gap-2 mb-6">
                            <i class="fa-solid fa-laptop-code text-durham-purple" aria-hidden="true"></i>
                            <span class="text-sm text-slate-600">Some prior knowledge useful</span>
                        </div>
                        <a href="/programs/#reading-groups" class="inline-block px-6 py-2 bg-durham-purple text-white font-medium text-sm rounded-lg transition-colors duration-300 hover:bg-[#7a2d80]">
                            Learn More
                        </a>
                    </div>
                </div>
                
                <!-- Second row: 3 cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="program-card rounded-2xl p-8 text-center">
                        <div class="mb-6">
                            <i class="fas fa-terminal text-5xl text-durham-purple mb-4"></i>
                            <h4 class="text-2xl font-bold">Research Project Support</h4>
                            <div class="w-16 h-1 bg-durham-purple mx-auto rounded-full mt-3"></div>
                        </div>
                        <p class="mb-6 leading-relaxed text-slate-600">
                            We support you to pursue AI safety research. 
                            We can support applications for fellowships and funding,
                            and advise students on dissertation and independent study projects.
                        </p>
                        <div class="flex items-center justify-center gap-2 mb-6">
                            <i class="fa-solid fa-graduation-cap text-durham-purple" aria-hidden="true"></i>
                            <span class="text-sm text-slate-600">Faculty &amp; Students</span>
                        </div>
                        <a href="/programs/#research-projects" class="inline-block px-6 py-2 bg-durham-purple text-white font-medium text-sm rounded-lg transition-colors duration-300 hover:bg-[#7a2d80]">
                            Learn More
                        </a>
                    </div>
                    
                    <div class="program-card rounded-2xl p-8 text-center">
                        <div class="mb-6">
                            <i class="fas fa-microphone text-5xl text-durham-purple mb-4"></i>
                            <h4 class="text-2xl font-bold">Speaker Events</h4>
                            <div class="w-16 h-1 bg-durham-purple mx-auto rounded-full mt-3"></div>
                        </div>
                        <p class="mb-6 leading-relaxed text-slate-600">
                           Insightful talks by leading researchers and industry professionals who share their insights on AI safety and showcase their latest research.
                        </p>
                        <a href="/programs/#speaker-series" class="inline-block px-6 py-2 bg-durham-purple text-white font-medium text-sm rounded-lg transition-colors duration-300 hover:bg-[#7a2d80]">
                            Learn More
                        </a>
                    </div>
                    
                    <div class="program-card rounded-2xl p-8 text-center">
                        <div class="mb-6">
                            <i class="fas fa-users text-5xl text-durham-purple mb-4"></i>
                            <h4 class="text-2xl font-bold">Social Events</h4>
                            <div class="w-16 h-1 bg-durham-purple mx-auto rounded-full mt-3"></div>
                        </div>
                        <p class="mb-6 leading-relaxed text-slate-600">
                            Relaxed socials to connect and build community.
                        </p>
                        <div class="flex items-center justify-center gap-2 mb-6">
                            <i class="fa-solid fa-heart text-durham-purple" aria-hidden="true"></i>
                            <span class="text-sm text-slate-600">Everyone welcome</span>
                        </div>
                        <a href="/programs/#socials" class="inline-block px-6 py-2 bg-durham-purple text-white font-medium text-sm rounded-lg transition-colors duration-300 hover:bg-[#7a2d80]">
                            Learn More
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Research Section -->
    <section id="research" class="py-16 section-neutral">
        <div class="site-container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold mb-6">Research</h2>
                <div class="w-24 h-1 bg-gradient-to-r from-bright-purple to-light-purple mx-auto rounded-full mb-8"></div>
            </div>

            <ResearchCarousel 
                papers={research} 
                title="Latest Publications & Projects" 
                id="home-research-carousel" 
            />
            <div class="text-center mb-16">
                <a href="/research" class="btn btn-secondary mb-12">View All Research</a>
            </div>
        </div>
    </section>

    <!-- Proudly Supported By Section -->
    <section id="supported-by" class="py-16 section-neutral">
        <div class="site-container mx-auto px-6">
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-4xl font-bold mb-6">Proudly Supported By</h2>
                <div class="w-24 h-1 bg-gradient-to-r from-bright-purple to-light-purple mx-auto rounded-full"></div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                {supporters.map((supporter) => (
                    <a href={supporter.link} target="_blank" rel="noopener noreferrer" class="flex flex-col items-center group">
                        <div class="involvement-card rounded-xl p-4 mb-3 transition-transform group-hover:scale-105 h-24 w-24 flex items-center justify-center">
                            <img src={`/images/supporters/${supporter.logo}`} alt={`${supporter.name} logo`} class="max-h-16 max-w-16 object-contain" />
                        </div>
                        <div class="text-center min-h-[3rem] flex flex-col justify-start">
                            <span class="text-base md:text-lg font-semibold">{supporter.name}</span>
                            {supporter.subtitle && <span class="text-sm text-slate-500">{supporter.subtitle}</span>}
                        </div>
                    </a>
                ))}
            </div>
        </div>
    </section>
</Layout>

<script>
    // Parallax effect for hero image
    const parallaxContainer = document.querySelector('.hero-parallax-container');
    const heroSection = document.querySelector('.hero-section');
    
    if (parallaxContainer && heroSection) {
        // Only enable on desktop with fine pointer (mouse)
        const isDesktop = window.matchMedia('(min-width: 768px) and (hover: hover) and (pointer: fine)').matches;
        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        
        if (isDesktop && !prefersReducedMotion) {
            let ticking = false;
            
            const updateParallax = () => {
                const scrolled = window.scrollY;
                const heroHeight = heroSection.offsetHeight;
                
                // Only apply parallax while hero is visible
                if (scrolled < heroHeight * 1.5) {
                    // Move at 40% of scroll speed for subtle effect
                    const yPos = scrolled * 0.4;
                    parallaxContainer.style.transform = `translate3d(0, ${yPos}px, 0)`;
                }
                ticking = false;
            };
            
            window.addEventListener('scroll', () => {
                if (!ticking) {
                    requestAnimationFrame(updateParallax);
                    ticking = true;
                }
            }, { passive: true });
        }
    }


    
    // Calendar loading state
    const calendarIframe = document.getElementById('calendar-iframe');
    const calendarLoading = document.getElementById('calendar-loading');
    
    // Hide loading state when calendar is loaded
    if (calendarIframe && calendarLoading) {
        calendarIframe.addEventListener('load', () => {
            calendarLoading.style.display = 'none';
            calendarIframe.classList.add('loaded');
        });
    }
    
    // Fallback to hide loading state after 5 seconds if load event doesn't fire
    setTimeout(() => {
        if (calendarIframe && calendarLoading && !calendarIframe.classList.contains('loaded')) {
            calendarLoading.style.display = 'none';
            calendarIframe.classList.add('loaded');
        }
    }, 5000);
</script>

<style>
/* Calendar loading styles */
.calendar-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 400px;
}

.calendar-iframe {
    opacity: 0;
    transition: opacity 0.3s ease;
}

.calendar-iframe.loaded {
    opacity: 1;
}

/* Spinner animation */
.spinner {
    width: 40px;
    height: 40px;
    border: 4px solid rgba(235, 128, 253, 0.2);
    border-top-color: var(--color-bright-purple);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.calendar-container {
    position: relative;
}

/* Luma calendar responsive wrapper */
.luma-calendar-wrapper {
    position: relative;
    width: 100%;
    max-width: 100%;
}

.luma-calendar-wrapper .calendar-iframe {
    width: 100%;
    min-height: 450px;
    height: 600px;
    border: 1px solid rgba(191, 203, 218, 0.533);
    border-radius: 4px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .luma-calendar-wrapper .calendar-iframe {
        height: 500px;
        min-height: 400px;
    }
}
</style>

